{
    use esmith::NetworksDB;
    use Time::Seconds;
    my $unautheCall = ${'nethcti-server'}{'UnautheCall'} || "disabled";
    my $allowedIp = ${'nethcti-server'}{'UnautheCallAddress'} || esmith::NetworksDB->local_access_spec();
    my $autheEnabled = ${'nethcti-server'}{'AuthenticationEnabled'} || "false";

    my $expiration_timeout = 24 * ONE_HOUR;    # Calculate 24 hours in seconds

    $OUT = '{
    "enabled": ' . $autheEnabled . ',
    "type": "pam",
    "file": {
        "path": "/etc/nethcti/users.json"
    },
    "expiration_timeout": "' . $expiration_timeout . '",
    "unauthe_call": {
        "status": "' . $unautheCall . '",
        "allowed_ip": "' . $allowedIp . '"
    }
}';
}
